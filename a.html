<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>打卡记录</title>
    <!-- import Vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
    <!-- import axios -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- import stylesheet -->
    <link rel="stylesheet" href="http://unpkg.com/iview/dist/styles/iview.css">
    <!-- import iView -->
    <script src="http://unpkg.com/iview/dist/iview.min.js"></script>
    <style>
      .header{
        margin:10px 0;
      }
      .nav{
        width:90%;
        margin:10px 5%;
      }
      .shadows{
          overflow: hidden;
          text-align:center;
          font-size:4em;
          background-image: -webkit-linear-gradient(left,green,yellow,pink, blue, red 25%,green 35%,
          blue 50%,yellow 60%, red 75%, pink 85%,blue 100%);
          -webkit-text-fill-color: transparent;
          -webkit-background-clip: text;
          animation: stream 15s infinite linear;
          background-size: 200% 100%;
      }
      @keyframes stream {
        0%  {
            background-position: 0 0;
        }
        100% {
            background-position: -100% 0;
        }
      }
    </style>
  </head>
  <body>
    <div id="app">
      <div>
          <div class="header">
            <div class="shadows">打卡记录</div>
          </div>
          <Card class="nav">
              <Date-Picker type="date" v-model="time" placeholder="开始时间"></Date-Picker>
              <i-button type="primary"  @click='search()'>查询</i-button>
          </Card>
          <!-- 表格数据 -->
          <Card class="nav">
            <i-table border :columns="columns1" :data="data1" :loading='loading'></i-table>
          </Card>
      </div>
    </div>
    <script>
        new Vue({
            el: '#app',
            data: {
              //设置时间选择日期
              options1: {
                  disabledDate (date) {
                      return date && date.valueOf() > Date.now();
                  }
              },
              time:"",
              //分页
              loading: true,
              data1:[],
              columns1: [
                   {
                      title: '头像',
                      align: 'center',
                      render: (h,params) => {
                        const row = params.row;
                        let button = [];
                        button.push(
                          h('Img',{
                            attrs:{
                              src:params.row.sign_in_head_url
                            },
                            style:{
                              width:"40px",
                              height:"40px",
                              marginTop:'15px',
                              marginBottom:'15px'
                            }
                          })
                        );
                        return h('div',{},button)
                      }
                  },
                  {
                      title: '姓名',
                      align: 'center',
                      key: 'sign_in_name'
                  },
                  {
                      title: '时间',
                      align: 'center',
                      key: 'sign_in_time'
                  },
                  {
                      title: '日期',
                      align: 'center',
                      key: 'sign_in_date'
                  },
                  {
                      title: '时间描述',
                      align: 'center',
                      key: 'sign_in_period_desc'
                  }
              ]
            },
            methods: {
              format(date){
                  var da = new Date(date);
                  var y = da.getFullYear();
                  var m = da.getMonth() + 1;
                  m = m < 10 ? ('0' + m) : m;
                  var d = da.getDate();
                  d = d < 10 ? ('0' + d) : d;
                  return y + '-' + m + "-" + d ;
              },
              nowdate () {
                  var d = new Date();
                  function addzero (v) {
                      if (v < 10) return '0' + v;
                      return v.toString();
                  }
                  var time = addzero(d.getFullYear()) + '-' + addzero(d.getMonth() + 1) + '-' + addzero(d.getDate());
                  return time;
              },
              init(){
                var time = this.nowdate();
                this.time = time;
              },
              search(){
                var that = this;
                axios({
                  method: 'get',
                  // url: 'https://easy-mock.com/mock/5b7e69e158f058243aafc5d8/clockin/api/clockin/suc/list',
                  url:"http://wx.tongbill.com/api/clockin/suc/list",
                  timeout: 30000,
                  dateType: 'json',
                  emulateJSON: true,
                  params: {
                    date: this.format(this.time)
                  }
                })
                .then(function (res) {
                  that.loading = false;
                  that.data1 = res.data.data;
                })
                .catch(function (error) {
                  that.loading = false;
                });
              }
            },
            mounted(){
              this.init();
              this.search();
            }
        })
      </script>
  </body>
</html>
